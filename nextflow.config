params {
    input_files = 'data/*.fastq.gz'
    input_results = 'fastqc_results/*'
}

process {
    container = 'ghcr.io/sage-bionetworks-workflows/nf-artist:latest'
    executor = 'local'
    maxRetries = 3
    errorStrategy = 'retry'
}

docker.enabled = true

profiles {
    // Base profile
    standard {
        process.executor = 'local'
    }
    
    // Tower-specific profile
    tower {
        process {
            withLabel: process_low {
                cpus = {1 * task.attempt}
                memory = {2.GB * task.attempt}
                maxRetries = 3
                errorStrategy = {task.attempt <= 2 ? 'retry' : 'ignore'}
            }
            withLabel: process_medium {
                cpus = {4 * task.attempt}
                memory = {8.GB * task.attempt}
                maxRetries = 3
                errorStrategy = {task.attempt <= 3 ? 'retry' : 'ignore'}
            }
            withLabel: process_high {
                cpus = {8 * task.attempt}
                memory = {16.GB * task.attempt}
                maxRetries = 3
                errorStrategy = {task.attempt <= 3 ? 'retry' : 'ignore'}
            }
        }
    }
}